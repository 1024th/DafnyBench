Task description: fill in the algorithm and supporting annotations such that the provided formal specification verifies. Note the formal spec may rely on helper functions in its expression, and the LLM will need to create suitable ones on its own if necessary. The LLM is asked to implement the body of only one function, which may be done by creating additional helper functions in some cases.